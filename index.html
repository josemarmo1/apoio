<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Prof¬™ Julia Maria</title>
<meta name="description" content="Jogos pedag√≥gicos ‚Äî 5¬∫ ano ‚Äî aprender se divertindo." />

<!-- FONTS -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;800;900&family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">

<!-- FAVICON -->
<link rel="icon" type="image/png" href="imagens/ChatGPT Image 15 de set. de 2025, 13_51_15.png" />
<link rel="apple-touch-icon" href="imagens/ChatGPT Image 15 de set. de 2025, 13_51_15.png" />

<style>
  :root{
    --pink-50:#fff1f6; --pink-100:#ffd9e8; --pink-200:#ffe6f1;
    --pink-400:#ff80ae; --pink-500:#ff5c96;
    --mint-100:#e9fff7; --slate-900:#141922; --slate-700:#273043; --slate-500:#61708d;
    --green:#34c38f; --yellow:#f1c232; --red:#ef6464; --blue:#5a8bff;
    --radius:18px; --shadow:0 18px 40px rgba(20,25,34,.08); --space:clamp(14px,3vw,28px);
    --safe-top: env(safe-area-inset-top, 0px);
    --search-mobile-max: 200px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:'Nunito',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    background:linear-gradient(180deg,var(--pink-50),#fff); color:var(--slate-700);
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  body.immersive{overflow:hidden}

  /* ===== Topbar ===== */
  .topbar{
    position:sticky; top:0; z-index:50;
    background:rgba(255,255,255,.9);
    -webkit-backdrop-filter:blur(10px); backdrop-filter:blur(10px);
    border-bottom:1px solid #ffe1ef;
    padding-top:calc(var(--safe-top) * 1);
  }
  .nav{
    max-width:1200px; margin:0 auto; padding:10px var(--space);
    display:grid; align-items:center; gap:12px;
    grid-template-columns: 1fr auto 1fr;
  }
  .brand{display:flex; align-items:center; justify-self:start}
  .brand img{
    width:150px; height:150px; object-fit:contain; display:block;
    background:transparent; border-radius:0; box-shadow:none;
    filter:drop-shadow(0 2px 6px rgba(0,0,0,.08)) saturate(1.04) contrast(1.03);
    image-rendering:-webkit-optimize-contrast;
    -webkit-user-select:none; user-select:none; touch-action:manipulation;
  }
  .search{
    justify-self:center;
    width:100%; max-width:480px;
    display:flex; align-items:center; gap:10px;
    padding:10px 12px; border-radius:999px; border:1px solid #ffe1ef; background:#fff;
    min-height:44px;
  }
  .search .glass{font-size:18px; line-height:1}
  .search input{
    border:none; outline:none; font-size:1rem; flex:1 1 auto;
    -webkit-appearance:none; background:transparent;
  }
  .menu-btn{
    justify-self:end;
    display:flex; align-items:center; justify-content:center;
    width:44px; height:44px; border-radius:12px; border:1px solid #ffd7e7;
    background:#fff; cursor:pointer; font-size:20px; font-weight:900;
  }

  @media (max-width:600px){
    .nav{ gap:10px; grid-template-columns: auto 1fr auto; }
    .brand img{ width:120px; height:120px; }
    .search{
      padding:6px 10px; min-height:38px; gap:8px;
      max-width:var(--search-mobile-max); width:100%; justify-self:center; margin:0;
    }
    .search input{ font-size:.95rem; }
    .menu-btn{ width:40px; height:40px; }
  }

  /* Drawer filtros (mobile) */
  .drawer{
    position:fixed; inset:auto 0 0 0;
    background:#fff; border-top-left-radius:18px; border-top-right-radius:18px;
    box-shadow:0 -14px 40px rgba(16,16,24,.16);
    transform:translateY(110%); transition:transform .25s ease;
    z-index:60; padding:14px var(--space) max(16px,calc(env(safe-area-inset-bottom,0px) + 10px));
  }
  .drawer.open{ transform:translateY(0); }
  .drawer .drag{ width:46px; height:5px; border-radius:999px; background:#e9e9ee; margin:0 auto 10px; }
  .drawer h3{ margin:0 0 12px; font-family:'Poppins',sans-serif; font-weight:900; color:#141922; font-size:1.05rem }
  .drawer .row{ display:flex; gap:10px; flex-wrap:wrap }
  .select{
    border:1px solid #ffe1ef; background:#fff; border-radius:999px; padding:10px 12px;
    font-weight:800; color:#7a3e53; min-height:40px;
  }
  .overlay{
    position:fixed; inset:0; background:rgba(0,0,0,.38); z-index:55; opacity:0; pointer-events:none; transition:opacity .2s ease;
  }
  .overlay.show{ opacity:1; pointer-events:auto; }

  /* ===== Hero ===== */
  .hero{position:relative; overflow:hidden; background:linear-gradient(180deg,#ffe9f2,var(--mint-100));}
  .hero .wrap{
    max-width:1200px; margin:0 auto; padding:20px var(--space) 10px; display:grid; gap:12px;
    grid-template-columns:1fr; align-items:center;
  }
  .h-title{
    margin:0; font-family:'Poppins',sans-serif; font-weight:900; color:#141922;
    font-size:clamp(1.4rem,3.4vw,2.3rem);
  }
  .h-sub{margin:6px 0 8px; color:#7a3e53; font-weight:800; font-size:clamp(1rem,2vw,1.15rem)}
  .ticker{
    height:54px; border-radius:14px; border:1px solid #ffe1ef; background:linear-gradient(90deg,#fff,#fff0);
    position:relative; overflow:hidden; box-shadow:var(--shadow);
  }
  .ticker-track{
    position:absolute; inset:0; display:flex; align-items:center; gap:36px; padding:0 14px;
    animation:scroll 22s linear infinite; white-space:nowrap; font-weight:900; color:#7a3e53;
  }
  .pill{
    display:inline-flex; align-items:center; gap:8px; padding:8px 14px; border-radius:999px;
    border:1px solid #ffd3e4; background:#fff; font-size:.98rem;
  }
  @keyframes scroll{ from{transform:translateX(0)} to{transform:translateX(-50%)} }
  .wave{display:block;width:100%;height:auto}

  /* ===== Cards ===== */
  .section{max-width:1200px; margin:0 auto; padding:20px var(--space)}
  .sec-title h2{ margin:0; font-family:'Poppins',sans-serif; font-weight:900; color:#141922; font-size:clamp(1.2rem,2.2vw,1.7rem) }
  .grid{ display:grid; gap:clamp(12px,2vw,18px); margin-top:14px; grid-template-columns:repeat(1,minmax(0,1fr)); }
  @media (min-width:760px){ .grid{grid-template-columns:repeat(2,1fr)} }
  @media (min-width:1060px){ .grid{grid-template-columns:repeat(3,1fr)} }
  @media (min-width:1360px){ .grid{grid-template-columns:repeat(4,1fr)} }
  .card{ background:#fff; border:1px solid #ffe1ef; border-radius:18px; box-shadow:var(--shadow); display:grid; grid-template-rows:auto 1fr auto; overflow:hidden; }
  .thumb{display:grid; place-items:center; height:170px; border-bottom:1px solid #ffe1ef}
  .thumb span{font-size:48px}
  .card-body{padding:14px}
  .card h3{margin:0 0 6px; font-size:clamp(1.06rem,1.4vw,1.25rem); color:#141922; font-weight:900}
  .card p{margin:0; color:#61708d; font-size:clamp(.95rem,1vw,1.05rem)}
  .tags{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
  .tag{font-size:.85rem; padding:6px 10px; border-radius:999px; background:#fff; border:1px solid #ffd3e4; color:#7a3e53; font-weight:800}
  .card-actions{display:flex; gap:10px; padding:12px; border-top:1px solid #ffe1ef; background:#fff}
  .btn{flex:1; border:none; border-radius:12px; padding:14px 16px; font-weight:900; cursor:pointer; min-height:52px}
  .btn-play{background:linear-gradient(90deg,var(--pink-400),var(--pink-500)); color:#fff}
  .btn-rank{background:#fff; border:1px solid #ffd3e4; color:#273043}

  /* ===== Modais ===== */
  dialog::backdrop{background:rgba(0,0,0,.45)}
  dialog{border:none; border-radius:20px; padding:0; overflow:hidden; box-shadow:0 40px 110px rgba(0,0,0,.25); width:min(1100px,96vw)}
  .modal-header{
    display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:10px;
    padding:10px 12px; background:var(--pink-100); border-bottom:1px solid #ffd3e4
  }
  .modal-title{font-weight:900; color:#141922; justify-self:center}
  .icon-btn{background:#fff; border:1px solid #ffd3e4; border-radius:10px; padding:8px 12px; cursor:pointer; font-weight:900; min-height:44px}
  .modal-body{background:#f8fbff; padding:0}
  dialog.fullscreen{width:100vw; height:100dvh; max-width:none; max-height:none; border-radius:0;}
  dialog.fullscreen .modal-body{ height:calc(100dvh - 52px); display:grid; place-items:center; padding:clamp(10px,2vw,24px); }

  /* ===== Jogo ===== */
  #game-container{ width:clamp(320px, 70vw, 980px); max-width:96vw; background:#fff; border:1px solid #eef2f5; border-radius:14px; box-shadow:0 6px 12px rgba(0,0,0,.06); padding:clamp(16px,2vw,26px); display:flex; flex-direction:column; gap:12px; text-align:center; }
  @media (max-width:600px){ #game-container{ width:min(540px, 96vw); border-radius:12px; } }
  .screen{display:flex; flex-direction:column; align-items:center; gap:12px; width:100%}
  .options{display:flex; flex-direction:column; gap:12px; width:min(760px,100%)}
  .option-btn{ background:#eef2ff; color:#1f2a3a; border:none; border-radius:12px; padding:16px; font-weight:900; cursor:pointer; font-size:clamp(1rem,1.2vw,1.2rem); min-height:56px; transition:transform .05s ease; }
  .option-btn:active{transform:scale(.99)}
  .btn-start{background:linear-gradient(90deg,var(--pink-400),var(--pink-500)); color:#fff; box-shadow:0 10px 24px rgba(255,92,150,.25)}
  .btn-level-f{background:var(--green); color:#fff}
  .btn-level-m{background:var(--yellow); color:#fff}
  .btn-level-d{background:var(--red); color:#fff}
  .btn-green{background-color:var(--green); color:#fff}
  .btn-red{background-color:var(--red); color:#fff}
  #player-input{width:min(420px,100%); padding:14px 16px; border:1px solid #e6e6e6; border-radius:12px; text-align:center; font-size:1.05rem}
  #level-display{font-weight:900}
  .rules{ max-width:720px; font-size:.95rem; color:#6d3b4f; background:#fff5fa; border:1px solid #ffd6e6; padding:10px 12px; border-radius:12px; }
  .hidden{display:none}

  /* ===== Ranking ===== */
  .filter-bar{display:flex; gap:8px; flex-wrap:wrap; align-items:center; padding:10px 12px; background:#fff; border-bottom:1px solid #f1e2ea}
  .rank-wrap{padding:14px}
  .rank-list{list-style:none; padding:0; margin:0; display:grid; gap:10px}
  .rank-item{display:flex; justify-content:space-between; align-items:center; background:#fff; border:1px solid #f1e2ea; border-radius:12px; padding:12px 14px}

  /* ===== Footer ===== */
  footer{background:#fff; border-top:1px solid #ffe1ef; margin-top:20px}
  .foot{max-width:1200px; margin:0 auto; padding:18px var(--space); text-align:center; color:#61708d}
  .foot small{display:block; color:#7a3e53}
</style>
</head>
<body>

<!-- ===== Topo ===== -->
<div class="topbar">
  <div class="nav">
    <div class="brand">
      <img src="imagens/48b51d5a-9d87-436d-8617-8a9801c054ac.png" alt="Logo Prof¬™ Julia Maria" />
    </div>

    <div class="search" role="search" aria-label="Busca e filtros">
      <span class="glass">üîé</span>
      <input id="q" type="search" placeholder="Buscar jogo..." oninput="applyFilters()" />
    </div>

    <button class="menu-btn" id="open-drawer" aria-label="Abrir filtros">‚ò∞</button>
  </div>
</div>

<!-- Drawer mobile de filtros -->
<div class="overlay" id="overlay" onclick="closeDrawer()"></div>
<div class="drawer" id="drawer" aria-modal="true" role="dialog" aria-label="Filtros">
  <div class="drag"></div>
  <h3>Filtros</h3>
  <div class="row">
    <select id="m-filter-subj" class="select" onchange="syncFiltersAndApply()">
      <option value="">Mat√©ria</option>
      <option>Matem√°tica</option>
      <option>Ci√™ncias da Natureza</option>
      <option>Ci√™ncias Humanas</option>
      <option>L√≠ngua Portuguesa</option>
    </select>
    <select id="m-filter-year" class="select" onchange="syncFiltersAndApply()">
      <option value="">Ano</option>
      <option>5¬∫ ano</option>
    </select>
  </div>
</div>

<!-- ===== Hero ===== -->
<section class="hero">
  <div class="wrap">
    <div>
      <h1 class="h-title">Aprender brincando: jogos curtos, objetivos e divertidos</h1>
      <p class="h-sub">Conte√∫dos pedag√≥gicos</p>

      <div class="ticker" aria-hidden="true">
        <div class="ticker-track">
          <span class="pill">üìè Unidades</span>
          <span class="pill">üçï Fra√ß√µes</span>
          <span class="pill">‚ûï Naturais</span>
          <span class="pill">üî¢ Posicional</span>
          <span class="pill">üìê √Årea & Per√≠metro</span>
          <span class="pill">‚è∞ Tempo</span>
          <span class="pill">üìè Unidades</span>
          <span class="pill">üçï Fra√ß√µes</span>
          <span class="pill">‚ûï Naturais</span>
          <span class="pill">üî¢ Posicional</span>
          <span class="pill">üìê √Årea & Per√≠metro</span>
          <span class="pill">‚è∞ Tempo</span>
        </div>
      </div>
    </div>
  </div>
  <svg class="wave" viewBox="0 0 1440 90" preserveAspectRatio="none" aria-hidden="true">
    <path fill="#ffffff" d="M0,64L60,58.7C120,53,240,43,360,48C480,53,600,75,720,85.3C840,96,960,96,1080,85.3C1200,75,1320,53,1380,42.7L1440,32L1440,0L0,0Z"></path>
  </svg>
</section>

<!-- ===== Jogos ===== -->
<section class="section" id="games">
  <div class="sec-title"><h2>Jogos em destaque</h2></div>
  <div class="grid" id="games-grid"></div>
</section>

<!-- ===== Modal do Jogo ===== -->
<dialog id="game-modal" aria-label="Jogo" class="fullscreen">
  <div class="modal-header">
    <button class="icon-btn" onclick="backFromGame()">‚Üê Voltar</button>
    <div class="modal-title" id="modal-title">Jogo</div>
    <span></span>
  </div>
  <div class="modal-body">
    <div id="game-container">
      <div id="start-screen" class="screen">
        <h3 id="game-name" style="margin:0;color:#7a3e53;font-weight:900">Jogo</h3>
        <input type="text" id="player-input" placeholder="Seu nome" autocomplete="name" />
        <div class="rules">
          <strong>Como funciona:</strong> escolha um n√≠vel. Cada acerto soma pontos e cada erro desconta pontos.
          <br/>F√°cil: +3 / ‚àí1 ‚Ä¢ M√©dio: +5 / ‚àí2 ‚Ä¢ Dif√≠cil: +10 / ‚àí3.
        </div>
        <div class="options" role="group" aria-label="N√≠veis">
          <button class="option-btn btn-level-f" id="btn-facil"   onclick="selectLevel('facil')"   disabled>F√°cil</button>
          <button class="option-btn btn-level-m" id="btn-medio"   onclick="selectLevel('medio')"   disabled>M√©dio</button>
          <button class="option-btn btn-level-d" id="btn-dificil" onclick="selectLevel('dificil')" disabled>Dif√≠cil</button>
        </div>
        <button id="start-btn" class="option-btn btn-start" onclick="startSelectedGame()" disabled>Come√ßar</button>
      </div>

      <div id="game-screen" class="screen hidden">
        <p id="level-display" style="font-weight:900;"></p>
        <div id="question-box">
          <p id="question-text" style="font-size:1.12rem"></p>
          <!-- imagem ilustrativa da quest√£o -->
          <img id="question-img" alt="Ilustra√ß√£o da quest√£o" style="max-width:min(560px, 96%); width:100%; height:auto; border:1px solid #eef2f5; border-radius:12px; background:#fff" />
        </div>
        <div id="options-container" class="options">
          <button id="option-a" class="option-btn" onclick="checkAnswer('a')"></button>
          <button id="option-b" class="option-btn" onclick="checkAnswer('b')"></button>
          <button id="option-c" class="option-btn" onclick="checkAnswer('c')"></button>
        </div>
        <div id="feedback" class="hidden"></div>
        <p id="score-display-game">Pontua√ß√£o: 0</p>
        <button id="next-btn" class="option-btn" onclick="nextQuestion()">Pr√≥xima</button>
      </div>
    </div>
  </div>
</dialog>

<!-- ===== Modal de Ranking (GERAL) ===== -->
<dialog id="ranking-modal" aria-label="Ranking">
  <div class="modal-header">
    <button class="icon-btn" onclick="closeRanking()">‚Üê Voltar</button>
    <div class="modal-title" id="ranking-title">üèÜ Ranking Geral</div>
    <span></span>
  </div>
  <div class="modal-body">
    <div class="filter-bar">
      <strong id="rank-subtitle">Top 10 ‚Äî todos os jogos e n√≠veis</strong>
      <div style="flex:1"></div>
      <button class="chip" onclick="clearRanking()" title="Limpar ranking local (somente este dispositivo)">Limpar local</button>
    </div>
    <div class="rank-wrap">
      <ul class="rank-list" id="rank-list"></ul>
      <p class="rank-empty hidden" id="rank-empty">Ainda sem registros. Jogue para aparecer aqui!</p>
      <p style="margin-top:8px;opacity:.8">
        <small>
          Ranking geral ‚Ä¢ <span id="rank-count"></span> partidas registradas
        </small>
      </p>
    </div>
  </div>
</dialog>

<footer>
  <div class="foot">
    ¬© <span id="year"></span> Prof¬™ Julia Maria ‚Äî Reposit√≥rio de Jogos
    <small>Plataforma otimizada para tablets, celulares e desktops.</small>
  </div>
</footer>

<script>
  /* ===== Drawer mobile ===== */
  const drawer = document.getElementById('drawer');
  const overlay = document.getElementById('overlay');
  const openBtn = document.getElementById('open-drawer');

  function openDrawer(){
    drawer.classList.add('open'); overlay.classList.add('show');
    document.documentElement.style.overflow='hidden';
    document.body.style.overflow='hidden';
  }
  function closeDrawer(){
    drawer.classList.remove('open'); overlay.classList.remove('show');
    document.documentElement.style.overflow=''; document.body.style.overflow='';
  }
  openBtn.addEventListener('click', openDrawer);

  function syncFiltersAndApply(){ applyFilters(); }

  /* ===== Cards ===== */
  const gamesMeta = [
    { key:'unidades', title:'Unidades de Medida', desc:'Grandezas, convers√µes e instrumentos.', emoji:'üìè', subj:'Matem√°tica', year:'5¬∫ ano' },
    { key:'fracoes', title:'Fra√ß√µes: equival√™ncia e compara√ß√£o', desc:'Comparar, ordenar e reconhecer equival√™ncias.', emoji:'üçï', subj:'Matem√°tica', year:'5¬∫ ano' },
    { key:'naturais', title:'Opera√ß√µes com N√∫meros Naturais', desc:'Adi√ß√£o, subtra√ß√£o, multiplica√ß√£o e divis√£o.', emoji:'‚ûï', subj:'Matem√°tica', year:'5¬∫ ano' },
    { key:'posicional', title:'Valor Posicional e Arredondamento', desc:'Leitura, compara√ß√£o e arredondamento.', emoji:'üî¢', subj:'Matem√°tica', year:'5¬∫ ano' },
    { key:'area_perimetro', title:'Per√≠metro e √Årea', desc:'Ret√¢ngulos, quadrados e desafios.', emoji:'üìê', subj:'Matem√°tica', year:'5¬∫ ano' },
    { key:'tempo', title:'Medidas de Tempo', desc:'Leitura de horas e tempo decorrido.', emoji:'‚è∞', subj:'Matem√°tica', year:'5¬∫ ano' },
  ];
  function renderCards(){
    const grid=document.getElementById('games-grid'); grid.innerHTML='';
    gamesMeta.forEach(g=>{
      const el=document.createElement('article'); el.className='card';
      el.dataset.subj=g.subj; el.dataset.year=g.year;
      el.dataset.search=(g.title+' '+g.desc+' '+g.subj+' '+g.year).toLowerCase();
      el.innerHTML=`
        <div class="thumb"><span>${g.emoji}</span></div>
        <div class="card-body">
          <h3>${g.title}</h3>
          <p>${g.desc}</p>
          <div class="tags">
            <span class="tag">${g.year}</span>
            <span class="tag">${g.subj}</span>
          </div>
        </div>
        <div class="card-actions">
          <button class="btn btn-play" onclick="openGame('${g.key}', true)">Jogar</button>
          <button class="btn btn-rank" onclick="openRanking()">Ranking</button>
        </div>`;
      grid.appendChild(el);
    });
  }

  function applyFilters(){
    const q=document.getElementById('q').value.toLowerCase().trim();
    document.querySelectorAll('.card').forEach(card=>{
      const text=card.dataset.search;
      const okQ=!q || text.includes(q);
      card.style.display=okQ?'':'none';
    });
  }

  /* ============================================================
     Banco de quest√µes ‚Äî 5¬∫ ano
     (Mesmas quest√µes do envio anterior; imagens agora s√£o geradas
      automaticamente por SVG conforme o tema)
  ============================================================ */
  const gamesQuestions = {
    unidades: {
      facil: [
        { q:'Qual unidade usamos para medir a ALTURA de uma pessoa?', a:'Metros (m)', b:'Litros (L)', c:'Quilos (kg)', correct:'a' },
        { q:'1 metro tem‚Ä¶', a:'10 cent√≠metros', b:'100 cent√≠metros', c:'1000 cent√≠metros', correct:'b' },
        { q:'1 L equivale a‚Ä¶', a:'100 mL', b:'1000 mL', c:'10 000 mL', correct:'b' },
        { q:'A massa de uma melancia √© melhor medida em‚Ä¶', a:'Quilogramas (kg)', b:'Gramas (g)', c:'Toneladas (t)', correct:'a' },
        { q:'Temperatura do corpo √© medida em‚Ä¶', a:'Graus Celsius (¬∞C)', b:'Metros (m)', c:'Joules (J)', correct:'a' },
      ],
      medio: [
        { q:'Uma r√©gua de 30 cm tem quantos mil√≠metros?', a:'30 mm', b:'300 mm', c:'3000 mm', correct:'b' },
        { q:'2,5 m equivalem a‚Ä¶', a:'250 cm', b:'25 cm', c:'2500 cm', correct:'a' },
        { q:'0,75 L √© igual a‚Ä¶', a:'750 mL', b:'75 mL', c:'7,5 mL', correct:'a' },
        { q:'Se um pacote tem 500 g, isso √© igual a‚Ä¶', a:'0,5 kg', b:'5 kg', c:'50 kg', correct:'a' },
        { q:'A dist√¢ncia entre cidades se mede melhor em‚Ä¶', a:'Cent√≠metros (cm)', b:'Metros (m)', c:'Quil√¥metros (km)', correct:'c' },
      ],
      dificil: [
        { q:'Uma sala tem 6 m de comprimento. Em cm, isso vale‚Ä¶', a:'600 cm', b:'60 cm', c:'6000 cm', correct:'a' },
        { q:'Para encher 3,5 L, quantos mL s√£o necess√°rios?', a:'350 mL', b:'3500 mL', c:'35 000 mL', correct:'b' },
        { q:'Uma crian√ßa pesa 34 500 g. Em kg, √©‚Ä¶', a:'3,45 kg', b:'34,5 kg', c:'345 kg', correct:'b' },
        { q:'Uma corrida tem 1200 m. Em km, √©‚Ä¶', a:'0,12 km', b:'1,2 km', c:'12 km', correct:'b' },
        { q:'Um aqu√°rio tem 2,25 L. Isso equivale a‚Ä¶', a:'225 mL', b:'2250 mL', c:'22 500 mL', correct:'b' },
      ],
    },
    fracoes: {
      facil: [
        { q:'Qual fra√ß√£o representa metade?', a:'1/2', b:'1/3', c:'2/3', correct:'a' },
        { q:'Qual √© MAIOR?', a:'1/4', b:'1/2', c:'1/8', correct:'b' },
        { q:'3/4 √© equivalente a‚Ä¶', a:'6/8', b:'2/8', c:'3/8', correct:'a' },
        { q:'A fra√ß√£o de uma pizza com 2 de 4 peda√ßos √©‚Ä¶', a:'2/2', b:'2/3', c:'2/4', correct:'c' },
        { q:'Qual √© MENOR?', a:'3/10', b:'1/10', c:'5/10', correct:'b' },
      ],
      medio: [
        { q:'Ordene do MENOR para o MAIOR: 1/2, 1/4, 3/4', a:'1/4, 1/2, 3/4', b:'1/2, 1/4, 3/4', c:'3/4, 1/2, 1/4', correct:'a' },
        { q:'Qual fra√ß√£o √© equivalente a 4/6?', a:'2/3', b:'3/2', c:'6/4', correct:'a' },
        { q:'Complete: 5/10 = ?', a:'1/5', b:'1/2', c:'2/5', correct:'b' },
        { q:'Qual √© MAIOR?', a:'2/5', b:'3/10', c:'4/10', correct:'a' },
        { q:'Qual fra√ß√£o representa tr√™s quartos?', a:'4/3', b:'3/4', c:'1/3', correct:'b' },
      ],
      dificil: [
        { q:'Qual √© MAIOR?', a:'7/12', b:'2/3', c:'5/8', correct:'b' },
        { q:'Qual fra√ß√£o √© equivalente a 9/12?', a:'3/4', b:'2/3', c:'4/6', correct:'a' },
        { q:'Ordene do MAIOR para o MENOR: 5/6, 4/5, 7/8', a:'7/8, 5/6, 4/5', b:'5/6, 7/8, 4/5', c:'4/5, 5/6, 7/8', correct:'a' },
        { q:'Qual √© MENOR?', a:'3/5', b:'1/2', c:'5/9', correct:'b' },
        { q:'12/16 √© equivalente a‚Ä¶', a:'3/4', b:'2/4', c:'6/12', correct:'a' },
      ],
    },
    naturais: {
      facil: [
        { q:'45 + 27 = ?', a:'72', b:'68', c:'62', correct:'b' },
        { q:'90 ‚àí 35 = ?', a:'55', b:'45', c:'65', correct:'a' },
        { q:'8 √ó 7 = ?', a:'56', b:'49', c:'63', correct:'a' },
        { q:'36 √∑ 6 = ?', a:'8', b:'6', c:'7', correct:'a' },
        { q:'O dobro de 25 √©‚Ä¶', a:'45', b:'50', c:'75', correct:'b' },
      ],
      medio: [
        { q:'325 + 480 = ?', a:'705', b:'795', c:'805', correct:'b' },
        { q:'900 ‚àí 275 = ?', a:'725', b:'635', c:'625', correct:'c' },
        { q:'12 √ó 8 = ?', a:'80', b:'96', c:'108', correct:'b' },
        { q:'81 √∑ 9 = ?', a:'8', b:'9', c:'7', correct:'b' },
        { q:'Qual tem resto 2?', a:'30 √∑ 7', b:'25 √∑ 6', c:'28 √∑ 5', correct:'a' },
      ],
      dificil: [
        { q:'(48 √∑ 6) √ó 7 = ?', a:'56', b:'49', c:'58', correct:'a' },
        { q:'700 ‚àí (120 + 85) = ?', a:'505', b:'495', c:'515', correct:'b' },
        { q:'MMC de 6 e 8 = ?', a:'12', b:'24', c:'48', correct:'b' },
        { q:'MDC de 18 e 24 = ?', a:'6', b:'12', c:'18', correct:'b' },
        { q:'Complete: 5 √ó ___ = 135', a:'25', b:'27', c:'23', correct:'b' },
      ],
    },
    posicional: {
      facil: [
        { q:'No n√∫mero 4.582, o d√≠gito 5 vale‚Ä¶', a:'5 dezenas', b:'5 centenas', c:'5 unidades', correct:'b' },
        { q:'No n√∫mero 7.306, o 7 est√° na casa de‚Ä¶', a:'milhar', b:'centena', c:'dezena', correct:'a' },
        { q:'Arredonde 78 para a dezena mais pr√≥xima:', a:'70', b:'80', c:'90', correct:'b' },
        { q:'O d√≠gito 9 em 9.124 vale‚Ä¶', a:'9 milhares', b:'9 centenas', c:'9 dezenas', correct:'a' },
        { q:'Arredonde 144 para a centena mais pr√≥xima:', a:'100', b:'200', c:'150', correct:'a' },
      ],
      medio: [
        { q:'No n√∫mero 36.427, o 6 vale‚Ä¶', a:'6 milhares', b:'6 centenas', c:'6 dezenas', correct:'b' },
        { q:'Qual √© MAIOR?', a:'5.090', b:'5.009', c:'5.900', correct:'c' },
        { q:'Arredonde 2.649 para a centena mais pr√≥xima:', a:'2.600', b:'2.700', c:'2.650', correct:'b' },
        { q:'Em 80.501, quantas centenas completas?', a:'805', b:'8050', c:'80', correct:'a' },
        { q:'Qual √© MENOR?', a:'4.980', b:'4.908', c:'4.890', correct:'c' },
      ],
      dificil: [
        { q:'No n√∫mero 254.307, o 4 vale‚Ä¶', a:'4 centenas', b:'4 milhares', c:'4 dezenas de milhar', correct:'b' },
        { q:'Arredonde 49.450 para a milhar mais pr√≥xima:', a:'49.000', b:'49.500', c:'50.000', correct:'c' },
        { q:'Sequ√™ncia em ordem CRESCENTE:', a:'5.012, 5.021, 5.102', b:'5.120, 5.102, 5.210', c:'5.210, 5.201, 5.120', correct:'a' },
        { q:'3 dezenas de milhar + 4 centenas =', a:'30.400', b:'3.400', c:'34.000', correct:'a' },
        { q:'No n√∫mero 408.670, quantas dezenas?', a:'8.067', b:'40.867', c:'4067', correct:'c' },
      ],
    },
    area_perimetro: {
      facil: [
        { q:'Per√≠metro √©‚Ä¶', a:'a soma dos lados', b:'a √°rea pintada', c:'a diagonal', correct:'a' },
        { q:'Quadrado de lado 5 cm. Per√≠metro =', a:'10 cm', b:'20 cm', c:'25 cm¬≤', correct:'b' },
        { q:'Ret√¢ngulo 6 cm √ó 3 cm. √Årea =', a:'9 cm¬≤', b:'18 cm¬≤', c:'27 cm¬≤', correct:'b' },
        { q:'Quadrado de lado 4 m. √Årea =', a:'8 m¬≤', b:'12 m¬≤', c:'16 m¬≤', correct:'c' },
        { q:'Ret√¢ngulo 10 m √ó 2 m. Per√≠metro =', a:'24 m', b:'20 m', c:'12 m', correct:'a' },
      ],
      medio: [
        { q:'Ret√¢ngulo 7 cm √ó 5 cm. √Årea =', a:'35 cm¬≤', b:'24 cm¬≤', c:'12 cm¬≤', correct:'a' },
        { q:'Quadrado de lado 9 cm. Per√≠metro =', a:'18 cm', b:'36 cm', c:'81 cm¬≤', correct:'b' },
        { q:'Ret√¢ngulo 12 m √ó 4 m. Per√≠metro =', a:'16 m', b:'24 m', c:'32 m', correct:'c' },
        { q:'√ÅREA: ret√¢ngulo 8 m √ó 6 m =', a:'14 m¬≤', b:'28 m¬≤', c:'48 m¬≤', correct:'c' },
        { q:'Um terreno retangular 15 m √ó 10 m. √Årea =', a:'150 m¬≤', b:'25 m¬≤', c:'30 m¬≤', correct:'a' },
      ],
      dificil: [
        { q:'Quadrado √°rea 49 cm¬≤. Lado =', a:'7 cm', b:'14 cm', c:'6 cm', correct:'a' },
        { q:'Ret√¢ngulo per√≠metro 30 m, lados 10 m e ?', a:'5 m', b:'10 m', c:'15 m', correct:'a' },
        { q:'Sala 6 m √ó 4 m. Quantos m¬≤ de piso?', a:'10 m¬≤', b:'20 m¬≤', c:'24 m¬≤', correct:'c' },
        { q:'Jardim 9 m √ó 3 m. Per√≠metro =', a:'27 m', b:'24 m', c:'18 m', correct:'b' },
        { q:'Quadrado per√≠metro 28 cm. Lado =', a:'7 cm', b:'14 cm', c:'4 cm', correct:'a' },
      ],
    },
    tempo: {
      facil: [
        { q:'Um minuto tem‚Ä¶', a:'60 segundos', b:'100 segundos', c:'30 segundos', correct:'a' },
        { q:'Uma hora tem‚Ä¶', a:'60 minutos', b:'90 minutos', c:'120 minutos', correct:'a' },
        { q:'Das 2h √†s 5h, passam‚Ä¶', a:'2 horas', b:'3 horas', c:'4 horas', correct:'b' },
        { q:'Meia hora corresponde a‚Ä¶', a:'15 minutos', b:'30 minutos', c:'45 minutos', correct:'b' },
        { q:'Um dia tem‚Ä¶', a:'12 horas', b:'24 horas', c:'48 horas', correct:'b' },
      ],
      medio: [
        { q:'45 minutos = ? horas', a:'0,45 h', b:'0,75 h', c:'0,75 min', correct:'b' },
        { q:'Das 8:15 √†s 9:00, passam‚Ä¶', a:'30 min', b:'45 min', c:'60 min', correct:'b' },
        { q:'2 h e 30 min = ? min', a:'120 min', b:'150 min', c:'180 min', correct:'b' },
        { q:'Se a aula come√ßou 13:40 e acabou 15:10, durou‚Ä¶', a:'1h10', b:'1h30', c:'2h10', correct:'b' },
        { q:'Trimestre tem cerca de‚Ä¶', a:'3 meses', b:'4 meses', c:'6 meses', correct:'a' },
      ],
      dificil: [
        { q:'Um filme dura 1h55. Em minutos √©‚Ä¶', a:'105 min', b:'115 min', c:'125 min', correct:'b' },
        { q:'Come√ßa 07:35 e termina 11:10. Dura√ß√£o:', a:'3h25', b:'3h35', c:'4h25', correct:'a' },
        { q:'Se passaram 2 ¬Ω horas. Em minutos:', a:'120', b:'140', c:'150', correct:'c' },
        { q:'Quinze dias equivalem a‚Ä¶', a:'duas semanas + 1 dia', b:'exatamente 2 semanas', c:'3 semanas', correct:'a' },
        { q:'Um bimestre tem‚Ä¶', a:'2 meses', b:'3 meses', c:'4 meses', correct:'a' },
      ],
    },
  };

  /* ===== Estado & Jogo ===== */
  let selectedGameKey=null, selectedLevel='', questionIndex=0, score=0, answered=false, playerName='';
  const modal=document.getElementById('game-modal');
  const modalTitle=document.getElementById('modal-title');
  const gameNameEl=document.getElementById('game-name');
  const playerInput=document.getElementById('player-input');
  const startBtn=document.getElementById('start-btn');
  const startScreen=document.getElementById('start-screen');
  const gameScreen=document.getElementById('game-screen');
  const levelDisplay=document.getElementById('level-display');
  const questionText=document.getElementById('question-text');
  const questionImg=document.getElementById('question-img');
  const optionA=document.getElementById('option-a');
  const optionB=document.getElementById('option-b');
  const optionC=document.getElementById('option-c');
  const feedbackEl=document.getElementById('feedback');
  const scoreDisplayGame=document.getElementById('score-display-game');
  const nextBtn=document.getElementById('next-btn');

  const levelPoints={facil:{correct:3,wrong:1}, medio:{correct:5,wrong:2}, dificil:{correct:10,wrong:3}};

  function openGame(key, autoFS=false){
    selectedGameKey=key; selectedLevel='';
    const meta=gamesMeta.find(g=>g.key===key);
    modalTitle.textContent = meta.title;
    gameNameEl.textContent = meta.title;
    resetGameState();
    if(!modal.open) modal.showModal();
    modal.classList.add('fullscreen');
    document.body.classList.add('immersive');
    if (autoFS) modal.requestFullscreen?.().catch(()=>{});
  }
  function backFromGame(){
    if(document.fullscreenElement) document.exitFullscreen?.();
    document.body.classList.remove('immersive');
    if(modal.open) modal.close();
  }

  function resetGameState(){
    questionIndex=0; score=0; answered=false; playerName=''; selectedLevel='';
    playerInput.value=''; startBtn.disabled=true;
    ['btn-facil','btn-medio','btn-dificil'].forEach(id=>{
      const el=document.getElementById(id); el.disabled=true; el.style.boxShadow='none';
    });
    startScreen.classList.remove('hidden'); gameScreen.classList.add('hidden');
  }
  document.addEventListener('input', e=>{
    if (e.target===playerInput){
      const ok=playerInput.value.trim().length>0;
      ['btn-facil','btn-medio','btn-dificil'].forEach(id=>document.getElementById(id).disabled=!ok);
      startBtn.disabled=!ok || !selectedLevel;
    }
  });
  function selectLevel(lvl){
    selectedLevel=lvl;
    const map={facil:'btn-facil',medio:'btn-medio',dificil:'btn-dificil'};
    ['btn-facil','btn-medio','btn-dificil'].forEach(id=>document.getElementById(id).style.boxShadow='none');
    document.getElementById(map[lvl]).style.boxShadow='0 0 0 3px rgba(0,0,0,.07), 0 0 0 4px var(--blue)';
    startBtn.disabled=!playerInput.value.trim().length;
  }
  function startSelectedGame(){
    playerName=playerInput.value.trim();
    if(!playerName){ alert('Digite seu nome para come√ßar.'); return; }
    if(!selectedLevel){ alert('Escolha um n√≠vel.'); return; }
    startScreen.classList.add('hidden'); gameScreen.classList.remove('hidden');
    levelDisplay.textContent=`N√≠vel: ${selectedLevel.charAt(0).toUpperCase()+selectedLevel.slice(1)}`;
    scoreDisplayGame.textContent='Pontua√ß√£o: 0';
    showQuestion();
  }

  function currentList(){
    return (gamesQuestions[selectedGameKey]?.[selectedLevel]) || [];
  }

  function showQuestion(){
    const list = currentList();
    if (questionIndex >= list.length || list.length === 0){
      endGame();
      return;
    }
    answered=false; feedbackEl.classList.add('hidden'); nextBtn.classList.add('hidden');
    const current=list[questionIndex];
    questionText.textContent=current.q;
    // imagem gerada conforme tema
    questionImg.src = makeIllustrationDataURL(selectedGameKey, current, questionIndex);
    questionImg.style.display = 'block';

    optionA.textContent=`a) ${current.a}`; optionB.textContent=`b) ${current.b}`; optionC.textContent=`c) ${current.c}`;
    [optionA,optionB,optionC].forEach(btn=>btn.classList.remove('btn-green','btn-red'));
  }

  function checkAnswer(answer){
    if(answered) return; answered=true;
    const list=currentList(); const current=list[questionIndex];
    const pts=levelPoints[selectedLevel]||levelPoints.facil;
    if(current && answer===current.correct){
      score+=pts.correct; feedbackEl.textContent=`Correto! (+${pts.correct})`; feedbackEl.style.color='green';
      document.getElementById(`option-${answer}`).classList.add('btn-green');
    }else{
      score-=pts.wrong; feedbackEl.textContent=`Ops! (-${pts.wrong})`; feedbackEl.style.color='#b00020';
      document.getElementById(`option-${answer}`).classList.add('btn-red');
    }
    scoreDisplayGame.textContent=`Pontua√ß√£o: ${score}`;
    feedbackEl.classList.remove('hidden'); nextBtn.classList.remove('hidden');
  }

  function nextQuestion(){
    questionIndex++;
    showQuestion();
  }

  /* =================== RANKING GERAL (Local + Google Sheets opcional) =================== */
  const RANKING_KEY = 'ranking_geral_v1';
  const SHEETS_WEBAPP_URL = ''; // <-- COLE AQUI a URL do seu Web App do Apps Script (POST)

  function loadRankingAll(){
    try{ return JSON.parse(localStorage.getItem(RANKING_KEY)) || []; }catch{return [];}
  }
  function saveRankingAll(arr){
    try{ localStorage.setItem(RANKING_KEY, JSON.stringify(arr)); }catch{}
  }
  function addToRankingAll(entry){
    // entry = {name, score, game, level, dateISO}
    const all = loadRankingAll();
    all.push(entry);
    // mant√©m at√© 200 registros locais (para n√£o crescer infinito)
    if (all.length > 200) all.shift();
    // ordena√ß√£o apenas na exibi√ß√£o
    saveRankingAll(all);
  }
  async function postToSheets(entry){
    if(!SHEETS_WEBAPP_URL) return;
    try{
      await fetch(SHEETS_WEBAPP_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify(entry)
      });
    }catch(e){
      console.warn('Falha ao enviar para Sheets:', e?.message || e);
    }
  }

  async function endGame(){
    const entry = {
      name: playerName || 'Jogador(a)',
      score,
      game: selectedGameKey,
      level: selectedLevel,
      dateISO: new Date().toISOString()
    };
    // salva local e tenta enviar ao Sheets
    addToRankingAll(entry);
    postToSheets(entry);

    alert(`Fim do jogo!\nPontua√ß√£o final: ${score}`);
    backFromGame();
    openRanking(); // abre o ranking geral
  }

  function openRanking(){
    if(!rmodal.open) rmodal.showModal();
    renderRankingGeneral();
  }
  function closeRanking(){ if(rmodal.open) rmodal.close(); }
  function renderRankingGeneral(){
    const all = loadRankingAll();
    const sorted = all.slice().sort((a,b)=>b.score - a.score).slice(0, 10);
    rankList.innerHTML='';
    document.getElementById('rank-count').textContent = all.length;
    if(!sorted.length){ rankEmpty.classList.remove('hidden'); return; }
    rankEmpty.classList.add('hidden');
    sorted.forEach((e,i)=>{
      const labelGame = gamesMeta.find(g=>g.key===e.game)?.title || e.game;
      const li=document.createElement('li'); li.className='rank-item';
      li.innerHTML = `<strong>${i+1}. ${e.name}</strong>
                      <span>${e.score} pts ‚Ä¢ <small>${labelGame} ‚Äî ${e.level}</small></span>`;
      rankList.appendChild(li);
    });
  }
  function clearRanking(){
    if(confirm('Limpar ranking local deste dispositivo?')){ saveRankingAll([]); renderRankingGeneral(); }
  }

  /* ===== Modal Ranking (refer√™ncias DOM) ===== */
  const rmodal=document.getElementById('ranking-modal');
  const rankList=document.getElementById('rank-list');
  const rankEmpty=document.getElementById('rank-empty');

  /* =================== Ilustra√ß√µes (SVG data URL) =================== */
  function svgToDataUrl(svg){
    return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
  }

  function makeIllustrationDataURL(gameKey, qObj, idx){
    const W=700, H=360, bg='#ffffff', border='#ffd3e4', title='#7a3e53', main='#5a8bff', aux='#34c38f', text='#273043';
    const safeText = (t)=> String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');

    if(gameKey==='fracoes'){
      // Pizza fracionada simples com legenda
      const frac = (qObj.a.includes('/')? qObj.a : (qObj.b.includes('/')? qObj.b : (qObj.c.includes('/')? qObj.c : '1/2')));
      const [num,den] = frac.split('/').map(Number);
      const cx=180, cy=180, r=110;
      let slices='';
      for(let i=0;i<den;i++){
        const a1 = (2*Math.PI*i/den) - Math.PI/2;
        const a2 = (2*Math.PI*(i+1)/den) - Math.PI/2;
        const large = (a2-a1)>Math.PI?1:0;
        const x1 = cx + r*Math.cos(a1), y1 = cy + r*Math.sin(a1);
        const x2 = cx + r*Math.cos(a2), y2 = cy + r*Math.sin(a2);
        const filled = i < num ? main : '#eef2ff';
        slices += `<path d="M${cx},${cy} L${x1},${y1} A${r},${r} 0 ${large} 1 ${x2},${y2} Z" fill="${filled}" stroke="${border}"/>`;
      }
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
          <rect x="0" y="0" width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
          <g>
            <circle cx="${cx}" cy="${cy}" r="${r+1}" fill="#fff" stroke="${border}"/>
            ${slices}
          </g>
          <text x="360" y="120" font-family="Nunito" font-size="22" fill="${title}" font-weight="900">Fra√ß√µes</text>
          <text x="360" y="160" font-family="Nunito" font-size="18" fill="${text}">Exemplo visual de fatias de pizza.</text>
          <text x="360" y="200" font-family="Nunito" font-size="18" fill="${text}">Destaque: ${safeText(frac)}</text>
        </svg>`;
      return svgToDataUrl(svg);
    }

    if(gameKey==='unidades'){
      // R√©gua + garrafa + term√¥metro (√≠cones simples)
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
          <rect width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
          <!-- R√©gua -->
          <rect x="40" y="60" width="300" height="30" rx="6" fill="#ffe9f2" stroke="${border}"/>
          ${Array.from({length:31}).map((_,i)=>{
            const x=50+i*9.6; const h=i%5===0?20:12;
            return `<line x1="${x}" y1="${60}" x2="${x}" y2="${60+h}" stroke="${title}" stroke-width="2"/>`
          }).join('')}
          <text x="40" y="115" font-family="Nunito" font-size="16" fill="${text}">cm / mm</text>
          <!-- Garrafa (L/mL) -->
          <rect x="420" y="70" width="80" height="180" rx="16" fill="#e6f7ff" stroke="${border}"/>
          <rect x="420" y="170" width="80" height="80" rx="16" fill="${main}" opacity="0.5"/>
          <text x="410" y="270" font-family="Nunito" font-size="16" fill="${text}">Litros e mL</text>
          <!-- Term√¥metro -->
          <line x1="620" y1="60" x2="620" y2="240" stroke="${title}" stroke-width="8" />
          <circle cx="620" cy="250" r="18" fill="${aux}"/>
          <text x="600" y="290" font-family="Nunito" font-size="16" fill="${text}">¬∞C</text>
        </svg>`;
      return svgToDataUrl(svg);
    }

    if(gameKey==='naturais'){
      // Opera√ß√µes
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
          <rect width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
          <text x="40" y="90" font-family="Nunito" font-size="42" fill="${main}" font-weight="900">8 √ó 7 = ?</text>
          <text x="40" y="150" font-family="Nunito" font-size="32" fill="${title}">Somar, subtrair, multiplicar, dividir</text>
          <text x="40" y="200" font-family="Nunito" font-size="22" fill="${text}">Use estrat√©gias: decomposi√ß√£o, propriedades, estimativa.</text>
          <circle cx="560" cy="140" r="40" fill="#eef2ff" stroke="${border}"/>
          <text x="540" y="150" font-family="Nunito" font-size="28" fill="${text}" font-weight="900">?</text>
        </svg>`;
      return svgToDataUrl(svg);
    }

    if(gameKey==='posicional'){
      // Tabela de valor posicional
      const cols=['Milhar','Centena','Dezena','Unidade'];
      const nums=[4,5,8,2];
      const svgCols = cols.map((c,i)=>{
        const x = 60 + i*150;
        return `
          <rect x="${x}" y="80" width="130" height="160" fill="#fff" stroke="${border}" rx="10"/>
          <text x="${x+65}" y="120" text-anchor="middle" font-family="Nunito" font-size="16" fill="${title}" font-weight="900">${c}</text>
          <text x="${x+65}" y="190" text-anchor="middle" font-family="Nunito" font-size="40" fill="${main}" font-weight="900">${nums[i]}</text>
        `;
      }).join('');
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
          <rect width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
          <text x="40" y="50" font-family="Nunito" font-size="22" fill="${title}" font-weight="900">Valor posicional (ex.: 4.582)</text>
          ${svgCols}
        </svg>`;
      return svgToDataUrl(svg);
    }

    if(gameKey==='area_perimetro'){
      // Ret√¢ngulo com √°rea e per√≠metro
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
          <rect width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
          <rect x="140" y="80" width="280" height="160" fill="#eefcf6" stroke="${aux}" stroke-width="3"/>
          <text x="280" y="170" font-family="Nunito" font-size="18" fill="${text}" text-anchor="middle">√Årea = base √ó altura</text>
          <text x="140" y="75" font-family="Nunito" font-size="16" fill="${title}">Per√≠metro = soma dos lados</text>
          <text x="460" y="120" font-family="Nunito" font-size="18" fill="${text}">Ex.: 7 cm √ó 5 cm ‚Üí 35 cm¬≤</text>
        </svg>`;
      return svgToDataUrl(svg);
    }

    if(gameKey==='tempo'){
      // Rel√≥gio simples
      const cx=180, cy=180, r=110;
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
          <rect width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
          <circle cx="${cx}" cy="${cy}" r="${r}" fill="#fff" stroke="${border}" stroke-width="3"/>
          ${Array.from({length:12}).map((_,i)=>{
            const ang = (i/12)*2*Math.PI - Math.PI/2;
            const x1=cx+ (r-15)*Math.cos(ang), y1=cy+(r-15)*Math.sin(ang);
            const x2=cx+ (r-5)*Math.cos(ang), y2=cy+(r-5)*Math.sin(ang);
            return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="${title}" stroke-width="3"/>`
          }).join('')}
          <!-- Ponteiros 10:10 -->
          <line x1="${cx}" y1="${cy}" x2="${cx+60*Math.cos(-Math.PI/6)}" y2="${cy+60*Math.sin(-Math.PI/6)}" stroke="${main}" stroke-width="6" stroke-linecap="round"/>
          <line x1="${cx}" y1="${cy}" x2="${cx+80*Math.cos(Math.PI/3)}" y2="${cy+80*Math.sin(Math.PI/3)}" stroke="${aux}" stroke-width="4" stroke-linecap="round"/>
          <circle cx="${cx}" cy="${cy}" r="5" fill="${text}"/>
          <text x="360" y="100" font-family="Nunito" font-size="22" fill="${title}" font-weight="900">Medidas de tempo</text>
          <text x="360" y="140" font-family="Nunito" font-size="18" fill="${text}">Minutos ‚Üî horas, dura√ß√£o de eventos, intervalos.</text>
        </svg>`;
      return svgToDataUrl(svg);
    }

    // padr√£o
    const svg = `
      <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}">
        <rect width="${W}" height="${H}" fill="${bg}" stroke="${border}"/>
        <text x="40" y="120" font-family="Nunito" font-size="22" fill="${title}" font-weight="900">${safeText(gameKey)}</text>
        <text x="40" y="170" font-family="Nunito" font-size="18" fill="${text}">${safeText(qObj.q)}</text>
      </svg>`;
    return svgToDataUrl(svg);
  }

  /* ===== Init ===== */
  function init(){
    renderCards(); applyFilters();
    document.getElementById('year').textContent=new Date().getFullYear();
  }
  document.addEventListener('DOMContentLoaded', init);
</script>

<!-- ===== (Removido Firestore para simplificar; agora ranking √© geral e local, com envio opcional ao Sheets) ===== -->
</body>
</html>

